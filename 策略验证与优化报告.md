# 策略验证与优化报告：从 AI 幻觉到市场真相

> **核心结论先行**：
> 1. AI 训练出的“复杂反转”权重被证实为**过拟合**，实盘中反转因子贡献为负。
> 2. 真正的 Alpha 来源被锁定为：**短期惯性 (Day 2) + 长期趋势 (Day 20)**。
> 3. 选出的股票是**短期爆发型**，持有 **20天胜率仅 41%**，但持有 **3天超额收益极高**。
> 4. **最终决策**：抛弃复杂权重，采用极简动量策略，并将换仓周期调整为 **3天**。

---

## 1. 探索过程 Step-by-Step

### Step 1: 由于 ETF 策略成功，尝试 AI 寻找个股权重
*   **目标**：在全市场（约3000只股票）中寻找最佳权重，战胜创业板指。
*   **方法**：差分进化算法，优化 Day 1, 2, 3, 5, 7, 10, 14, 20 的权重。
*   **初次结果（看起来很美）**：
    AI 给出了一个“完美”的逻辑故事：
    *   **Day 20 (+0.95)**：长期趋势向上。
    *   **Day 5-14 (-0.78)**：中期深度回调（超跌）。
    *   **Day 2 (+0.18)**：短期企稳。
    *   *逻辑：在牛股回调到位时买入，做超跌反弹。*

### Step 2: 鲁棒性验证（严刑拷打）
为了验证这不是“看图说故事”，我们编写了 `verify_model_robustness.py` 进行信号分解测试。

**测试结果（打脸时刻）：**

| 信号成分 | 单独回装 Sharpe | 结论 |
| :--- | :--- | :--- |
| **中期反转 (Day 5-14)** | **-0.68** | **负贡献！** 反转因子实际上在亏钱。 |
| **长期趋势 (Day 20)** | **1.12** | 有效，提供了基本的趋势过滤。 |
| **短期惯性 (Day 2)** | **5.30** | **核心 Alpha！** 策略赚钱全靠它。 |

**发现**：AI 为了迎合“高胜率”目标，强行拼凑了反转因子，但实际上是个累赘。

### Step 3: 持有期压力测试（回答用户疑问）
用户追问：“*选出来的 Top N 真的是强势股吗？持有 20 天能跑赢指数吗？*”

我们模拟了 2021-2026 年（1237个交易日）的真实交易数据：

| 持有天数 | 胜率 (vs 创业板) | 平均每期超额收益 | 年化超额估算 | 评价 |
| :--- | :--- | :--- | :--- | :--- |
| **20 天** | **41.3%** | **+0.11%** | ~1% | **失败。** 跑不赢指数，甚至亏损。 |
| 10 天 | 46.1% | +0.83% | ~20% | 勉强及格。 |
| 5 天 | 49.4% | +0.87% | ~50% | 还可以。 |
| **3 天** | **53.5%** | **+1.35%** | **> 100%** | **极强。** 这是短期爆发力的最佳窗口。 |

---

## 2. 详细数据验证

### 每日数据：持有 20 天 vs 持有 3 天
*(数据来源：`verify_20d_performance.py`)*

#### ❌ 方案 A：持有 20 天 (原计划)
- **胜率**: 41.3% (输多赢少)
- **盈亏比**: 1.44
- **2024年表现**: 平均每笔交易跑输指数 **-2.68%**。
- **结论**: 选出的股票爆发力强，但耐力差。20天太久，只争朝夕。利润在持有的一周后就被回撤吃光了。

#### ✅ 方案 B：持有 3 天 (新方案)
- **胜率**: 53.5%
- **平均每期超额**: **+1.35%** (这是扣除基准后的纯 Alpha)
- **结论**: 这种“短期惯性”策略必须快进快出，利用 Day 2 的余温在 3 天内收割利润。

---

## 3. 最终结论与实施

基于上述严谨的数据验证，我们做出了以下调整，现已全部落地：

### 1. 策略逻辑重构 (Simplification)
我们**抛弃**了 AI 训练出的复杂反转权重，回归简单直接的动量逻辑。

- **旧权重**：`{1:-0.04, 2:0.18, 3:-0.29, 5:-0.77, ..., 20:0.95}` (复杂且过拟合)
- **新权重**：
    ```python
    periods_weights = {
        2: 30,  # Short-term Impulse (Day 2 Return) - 进攻矛
        20: 70  # Long-term Trend (Day 20 Return)   - 防守盾
    }
    ```

### 2. 核心参数变更
在 `config.py` 中：
- `REBALANCE_PERIOD_T` 从 **10** 修改为 **3**。
- *注：虽然这增加了交易频率，但每期 +1.35% 的超额收益完全可以覆盖手续费（约0.1%）。*

### 3. 给用户的建议
您现在拥有的不再是一个黑箱 AI 模型，而是一个**经过统计学验证的、针对微盘/活跃股风格的短期动量策略**。

- **适用场景**：市场活跃、微盘股/妖股横行时（如 2023 年）。
- **风险提示**：在阴跌市（如 2024 年）中，Day 2 的惯性会失效，策略会自动回撤，但 Day 20 的正权重会起到保护作用（不选下跌趋势的票）。

---

### 附：如何复现验证？
您可以随时运行以下脚本来验证上述数据：
```bash
# 验证不同持有期的表现 (3/5/10/20天)
python verify_20d_performance.py

# 验证策略的鲁棒性 (时间外推/随机打乱测试)
python verify_model_robustness.py
```
